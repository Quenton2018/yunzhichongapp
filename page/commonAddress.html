<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	<meta name="misapplication-tap-highlight" content="no"/>
	<meta name="HandheldFriendly" content="true"/>
	<meta name="MobileOptimized" content="320"/>
	<title>常用地址</title>
	<link rel="stylesheet" href="../css/iconfont.css">
	<link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8"/>
	<link rel="stylesheet" href="../css/mui.min.css" type="text/css" charset="utf-8"/>

	<link rel="stylesheet" href="../plugins/layer/theme/default/layer.css" type="text/css" charset="utf-8"/>
	<!--引入公用样式-->
	<link rel="stylesheet" type="text/css" href="../css/public.css" />
	<script src="../js/jquery-3.3.1.min.js"></script>
	<script src="../js/mui.min.js"></script>
	<script src="../plugins/layer/layer.js"></script>
	<script src="../js/common.js"></script>
	<script src="../js/base.js"></script>

	<style type="text/css">

		.content{
			border-bottom:none;
		}


		#textarea{
			background: #EDEDED;
			border: none;
		}
	</style>
</head>
<body style="background: #fff;">

<header id="header2">
	<div class="headInner">
		<div class="left" id="back"  onclick="back()" ><img src="../img/app_back.png" /></div>
		<div class="right">&nbsp;</div>
		<div style="clear: both"></div>
	</div>
</header>

<div class="myContent" style="padding-top: 70px" >

	<h1 class="pageBigTitle">家庭地址</h1>

	<!--头部搜索框-->
	<div class="textBox" style="margin-top: 2rem;">
		<textarea id="textarea" name="content" rows="8" placeholder="请输入您的家庭地址"  maxlength="50"  ></textarea>
		<!--确认按键-->
		<div class="submitBtn" style="padding-top: 20px">
			<img src="../img/app_yes_btn.png" style="display: block;width: 100%">
		</div>
	</div>
</div>


</body>

<script type="text/javascript" charset="utf-8">
    mui.init();

    if(window.plus){
        pagePlusReady();
    }else{
        document.addEventListener('plusready',pagePlusReady,false);
    }
    function pagePlusReady(){

        uploadLoginInfo();

        getUserInfo();
    }

    /**
     * 获取用户信息
     */
    function getUserInfo(){
        var uuid = plus.storage.getItem("uuid");
        if(vaildeParam(uuid)){
            var homeAddress = plus.storage.getItem("homeAddress");
            if(vaildeParam(homeAddress)){
                $("#textarea").text(homeAddress);
            }
        }else{
            layer.msg(res.msg);
            clearLogin();
            clicked("page/login.html");
        }
    }
    var canPostFlag = true;
    /**
     * 修改家庭住址
     */
    $(".submitBtn").click(function(){
        var uuid = plus.storage.getItem("uuid");
        var content = $('#textarea').val();


        if(!canPostFlag){
            layer.msg("你操作太频繁了！");
            return;
        }

        canPostFlag = false;

        if(content.length<5){
            layer.msg("内容不能少于5个字");
            canPostFlag = true;
            return;
        }
        if( content.length>=50){
            layer.msg("内容不能大于50个字");
            canPostFlag = true;
            return;
        }
        if(!vaildeParam(content)){
            layer.msg("内容不能为空");
            canPostFlag = true;
            return;
        }
        var data = {
            "uuid":uuid,
            "gender":'',
            "nickname":'',
            "homeAddress":content
        }
        postJSON(API_URL.ApiUpdateMemberInfo,data,function(res){
            if("0" == res.code){
                layer.msg(res.msg);
                plus.storage.setItem( "homeAddress", content); //回写姓名
                setTimeout(function(){
                    back();
                },2000);
            }else{
                layer.msg(res.msg);
            }
        });
    });
</script>

</html>